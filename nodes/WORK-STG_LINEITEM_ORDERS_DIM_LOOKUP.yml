fileVersion: 1
id: 6883e2ee-6611-411e-abec-e78924eccf06
name: STG_LINEITEM_ORDERS_DIM_LOOKUP
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: WORK
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1926e18a-0b26-418f-86ec-e82ea74f7c5d
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_CUSTOMER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff33f256-49e4-42cd-827f-15d9dcd7d25b
                stepCounter: fd301fed-89bb-433a-aa41-fe22fd948b2b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9bdbb1c-d20a-4acd-b38a-a92dcc2261e7
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_PART_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 234bd3b0-764f-4202-8cef-e39ff6ad6aa6
                stepCounter: 7ae02e0b-ae93-4a8c-9c58-26ca8181074d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 703e1b50-acea-4673-bb7a-0faf935c0524
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59fa305c-2851-43d1-ae61-9e350e38f3af
                stepCounter: f92e80fd-fc52-4f17-897b-015c838d2833
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e5c777d-369c-484d-88c6-cc3b1e76d204
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ac80607-5e13-4f2c-867b-cf8da0192f37
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da4fcd4e-5a09-4d2a-bfe9-061ec39fa3f5
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea0d0c05-74cf-4740-b27c-5cecbf124319
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ee1cada-f3f1-4354-9592-8271127695aa
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_PARTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f03f3dc-8ae9-4b94-98cf-75495225e165
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df38145c-3eab-483b-990d-b81a3fdcf6fc
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 213fa087-4d6b-4a4e-be80-fd43692e1acd
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67187907-7576-4655-874d-a0819335b389
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7f585b2-ca45-4600-b48f-bed8defc4b6a
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e467e165-0d3a-4bfc-bf52-9a182f215ed1
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd691bec-dbdd-4cfd-97b0-f4e4193add75
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 504322fa-16a2-4a86-95b5-b749b9f6c867
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81a67a33-50a7-4d08-a7b1-7efb6ad4b133
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bd853d6-a9dd-459e-b403-9dd532892b19
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdedf976-7b49-4e96-84f8-443419b14898
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ee3239c-83f9-4436-8a93-4707f77b7958
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b81ed3c8-4a6c-419a-a6c9-655d63900f28
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3855e270-8b36-4185-b76e-14631504551e
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddddca60-9981-48be-9ff5-48e4ef971f49
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9da22f6b-d5ab-4acf-8979-2cbcbf22e0e0
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc1fb389-eb5b-4352-afd2-d1c7acb61f35
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1252817b-779b-4cd5-827c-0afc3b9123ab
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5200e85d-fc99-4f1e-9512-6d43f1345781
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2833c27-2d27-45c0-8a14-937371838661
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9316c7e6-b1fc-4235-a2de-d29079d20753
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a50c945-c40b-4ec3-b3e1-cbc31f3b63a1
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: DATE
        description: ""
        name: L_RECEIPTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c33850a5-9100-485b-b6f4-64c538c8b38e
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e06f2a1c-bea5-49b0-9990-e0e15a8e1f6a
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0088048d-52ac-4765-9bfc-1f0fe3f3ae54
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a511d83b-8aed-408b-b274-7bf51613af5f
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62d35075-e03c-42a9-b04c-fbf3f6f2a67e
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c15920c3-0c16-47fa-b5f2-1278d2e4b61f
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80364f55-f9ad-4c29-8e1e-2ef343c70aae
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da73df99-9809-483a-8cce-df4c86a9a544
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 043570b4-6500-4745-a2b0-12c8162be58e
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54c0e1a4-456b-4ad7-a01a-c0a21f5e5182
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75ad7bec-e210-41f5-82ff-a4325ba008e3
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11323df9-7428-416c-91f6-1367ea8f4d48
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c50bb060-c5c3-4d8c-842b-21de8d61e2d2
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0fff3f9-a3d2-4dc4-b77a-80e69ad14c4c
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae4c7f5a-5b02-4a7a-83fc-3ffcef614241
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 620748c5-dcc1-4f31-87f2-944249c9f861
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79d2a4f5-2f4e-4d66-93aa-d999289aeae7
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c52afe5-1a09-4c20-bbcb-8ffa3de45b98
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93c20374-e0e8-410d-a846-21a236a997c1
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6610a635-4d87-40f7-8a34-cbf19c62a51f
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d35890a-0645-49d5-98ed-652ecbdd7062
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e1e30b1-87d4-4e64-bc12-042068071b6d
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de4e79eb-032e-4763-8797-437cd4780154
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ad8e2e7-6911-4c55-a85a-49afcc4db196
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b399e4a0-34d1-43a6-a390-68f9c43767b6
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf91ccb0-4a71-4490-8c9f-a5458d7824ad
          stepCounter: 6883e2ee-6611-411e-abec-e78924eccf06
        config: {}
        dataType: NUMBER
        description: ""
        name: DAYS TO SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2991e5ff-67cf-4f25-a631-e57d77c2b09f
                stepCounter: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_CUSTOMER: fd301fed-89bb-433a-aa41-fe22fd948b2b
          DIM_PART: 7ae02e0b-ae93-4a8c-9c58-26ca8181074d
          DIM_SUPPLIER: f92e80fd-fc52-4f17-897b-015c838d2833
          STG_LINEITEM_ORDERS: 6bf81ff6-7b06-41dd-9103-3c5bf61f3aed
          STG_PARTSUPP: 0f367a01-ecb5-4600-9ec4-5b038913ab34
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: DIM_CUSTOMER
          - locationName: WORK
            nodeName: DIM_PART
          - locationName: WORK
            nodeName: DIM_SUPPLIER
          - locationName: WORK
            nodeName: STG_LINEITEM_ORDERS
          - locationName: WORK
            nodeName: STG_PARTSUPP
        join:
          joinCondition: |-
            FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"

            LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"

            ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"

            AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"

            /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */

            LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"

            ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"

            LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"

            ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"

            LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"

            ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND

            "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
        name: STG_LINEITEM_ORDERS_DIM_LOOKUP
        noLinkRefs: []
  name: STG_LINEITEM_ORDERS_DIM_LOOKUP
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
